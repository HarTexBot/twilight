<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Flow for managing ratelimit tickets."><title>twilight_http_ratelimiting::ticket - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-1def573a4779b29b.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../../static.files/light-d59023bfa12059d2.css"><link rel="stylesheet" disabled href="../../static.files/dark-1ca41bb1e10af075.css"><link rel="stylesheet" disabled href="../../static.files/ayu-18b4181a2f3fb862.css"><script src="../../static.files/storage-3891ce972e3a2bf8.js"></script><script defer src="../../static.files/main-98a684e84ae5b08b.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../twilight_http_ratelimiting/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../twilight_http_ratelimiting/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Module ticket</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#functions">Functions</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../index.html">twilight_http_ratelimiting</a>::<wbr><a class="mod" href="#">ticket</a><button id="copy-path" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../src/twilight_http_ratelimiting/ticket.rs.html#1-175">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Flow for managing ratelimit tickets.</p>
<p>Tickets are the <a href="../trait.Ratelimiter.html" title="trait twilight_http_ratelimiting::Ratelimiter"><code>Ratelimiter</code></a>’s method of managing approval for a consumer
to be able to send a request.</p>
<h2 id="ratelimit-consumer"><a href="#ratelimit-consumer">Ratelimit Consumer</a></h2><h3 id="1-requesting-a-ticket"><a href="#1-requesting-a-ticket">1. Requesting a ticket</a></h3>
<p>Consumers of a ratelimiter will call <a href="../trait.Ratelimiter.html#tymethod.ticket" title="associated function twilight_http_ratelimiting::Ratelimiter::ticket"><code>Ratelimiter::ticket</code></a>.</p>
<h3 id="2-waiting-for-approval"><a href="#2-waiting-for-approval">2. Waiting for approval</a></h3>
<p>In return consumers will receive a <a href="struct.TicketReceiver.html" title="struct twilight_http_ratelimiting::ticket::TicketReceiver"><code>TicketReceiver</code></a>. This must be polled
in order to know when the ratelimiter has approved a ticket.</p>
<h3 id="3-receiving-approval"><a href="#3-receiving-approval">3. Receiving approval</a></h3>
<p>When a ticket is approved and the future resolves, a <a href="struct.TicketSender.html" title="struct twilight_http_ratelimiting::ticket::TicketSender"><code>TicketSender</code></a> is
provided. This must be used to provide the ratelimiter with the response’s
ratelimit headers.</p>
<h3 id="4-performing-the-request"><a href="#4-performing-the-request">4. Performing the request</a></h3>
<p>Consumers may now execute the HTTP request associated with the ticket. Once
a response (or lack of one) is received, the headers <a href="../headers/index.html" title="mod twilight_http_ratelimiting::headers">must be parsed</a> and
sent to the ratelimiter via <a href="struct.TicketSender.html#method.headers" title="associated function twilight_http_ratelimiting::ticket::TicketSender::headers"><code>TicketSender::headers</code></a>. This completes the
cycle.</p>
<h2 id="ratelimiter"><a href="#ratelimiter">Ratelimiter</a></h2><h3 id="1-initializing-a-tickets-channels"><a href="#1-initializing-a-tickets-channels">1. Initializing a ticket’s channels</a></h3>
<p>Ratelimiters will accept a request for a ticket when <a href="../trait.Ratelimiter.html#tymethod.ticket" title="associated function twilight_http_ratelimiting::Ratelimiter::ticket"><code>Ratelimiter::ticket</code></a>
is called. You must call <a href="fn.channel.html" title="fn twilight_http_ratelimiting::ticket::channel"><code>channel</code></a> to create a channel between the
ratelimiter and the consumer.</p>
<h3 id="2-keeping-the-consumer-waiting"><a href="#2-keeping-the-consumer-waiting">2. Keeping the consumer waiting</a></h3>
<p><a href="fn.channel.html" title="fn twilight_http_ratelimiting::ticket::channel"><code>channel</code></a> will return two halves: <a href="struct.TicketNotifier.html" title="struct twilight_http_ratelimiting::ticket::TicketNotifier"><code>TicketNotifier</code></a> and
<a href="struct.TicketReceiver.html" title="struct twilight_http_ratelimiting::ticket::TicketReceiver"><code>TicketReceiver</code></a>. Ratelimiters must keep the notifier and give the user
the receiver in return.</p>
<h3 id="3-notifying-the-consumer-of-ticket-approval"><a href="#3-notifying-the-consumer-of-ticket-approval">3. Notifying the consumer of ticket approval</a></h3>
<p>When any ratelimits have passed and a user is free to perform their request,
call <a href="struct.TicketNotifier.html#method.available" title="associated function twilight_http_ratelimiting::ticket::TicketNotifier::available"><code>TicketNotifier::available</code></a>. If the user hasn’t canceled their
request for a ticket, you will receive a <a href="struct.TicketHeaders.html" title="struct twilight_http_ratelimiting::ticket::TicketHeaders"><code>TicketHeaders</code></a>.</p>
<h3 id="4-receiving-the-responses-headers"><a href="#4-receiving-the-responses-headers">4. Receiving the response’s headers</a></h3>
<p>The consumer will perform their HTTP request and parse the response’s
headers. Once the headers (or lack of headers) are available the user will
send them along the channel. Poll the provided <a href="struct.TicketHeaders.html" title="struct twilight_http_ratelimiting::ticket::TicketHeaders"><code>TicketHeaders</code></a> for those
headers to complete the cycle.</p>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left"><a class="struct" href="struct.TicketHeaders.html" title="struct twilight_http_ratelimiting::ticket::TicketHeaders">TicketHeaders</a></div><div class="item-right docblock-short">Receiver to wait for the headers sent by the API consumer.</div></div><div class="item-row"><div class="item-left"><a class="struct" href="struct.TicketNotifier.html" title="struct twilight_http_ratelimiting::ticket::TicketNotifier">TicketNotifier</a></div><div class="item-right docblock-short">Indicate to the ratelimit consumer that their ticket has been granted and
they may now send a request.</div></div><div class="item-row"><div class="item-left"><a class="struct" href="struct.TicketReceiver.html" title="struct twilight_http_ratelimiting::ticket::TicketReceiver">TicketReceiver</a></div><div class="item-right docblock-short">Channel receiver to wait for availability of a ratelimit ticket.</div></div><div class="item-row"><div class="item-left"><a class="struct" href="struct.TicketSender.html" title="struct twilight_http_ratelimiting::ticket::TicketSender">TicketSender</a></div><div class="item-right docblock-short">Channel sender to send response ratelimit information to the ratelimiter.</div></div></div><h2 id="functions" class="small-section-header"><a href="#functions">Functions</a></h2><div class="item-table"><div class="item-row"><div class="item-left"><a class="fn" href="fn.channel.html" title="fn twilight_http_ratelimiting::ticket::channel">channel</a></div><div class="item-right docblock-short">Produce a new channel consisting of a sender and receiver.</div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="twilight_http_ratelimiting" data-themes="" data-resource-suffix="" data-rustdoc-version="1.69.0-nightly (9aa5c24b7 2023-02-17)" data-search-js="search-14421e1532aead08.js" data-settings-js="settings-f0c5c39777a9a2f6.js" data-settings-css="settings-0bcba95ff279c1db.css" ></div></body></html>